var CzrSlider;!function(e){"use strict";e(function(){CzrSlider=function(){this.$body=e("body"),this._action="slider_action",this._nonce=SliderAjax.SliderCheckNonce,this.$_slider_section_box=e("#slider_sectionid"),this.$_slider_fields_box=e("#slider-fields-box"),this.$_tc_post_id=e("input#tc_post_id"),this._check_field="slider_check_field",this._context="attachment",e("input#post_slider_check_field").length>0&&(this._check_field="post_slider_check_field",this._context="post"),this.$_slider_check_field=e("input#"+this._check_field),this._color_picker_on="post"==this.$_context,this._color_picker_on&&(this._color_picker_func="object"==typeof jQuery.wp&&"function"==typeof jQuery.wp.wpColorPicker?"wpColorPicker":"farbtastic"),this._data={action:this._action,tc_post_id:this.$_tc_post_id.val(),SliderCheckNonce:this._nonce,tc_post_type:this._context},this.eventListeners(),this._init_sortable(),this._init_multipicker()},e.extend(CzrSlider.prototype,{eventListeners:function(){var e=this;this.$body.on("change","input#"+this._check_field,function(){e.ajax(e._build_data("enable"))}).on("change","select#post_slider_field",function(){e.ajax(e._build_data("select_slider"))}).on("sortupdate","#slider_sectionid #sortable",function(){e.ajax(e._build_data("reorder_slides"),"_reorder_slides_response")}).on("click","#tc_create_slider",function(){e.ajax(e._build_data("new_slider"))}).on("click","#delete-slider",function(){e.ajax(e._build_data("delete_slider"))})},ajax:function(i,t){var _=this;this.$_slider_fields_box.find(".spinner").show(),e.post(ajaxurl,i,function(e){t?_[t](e):_._default_response(e)})},_default_response:function(e){this.$_slider_fields_box.empty().append(e),this.$_slider_fields_box.find(".spinner").hide(),this._init_ext_plugins()},_reorder_slides_response:function(){var i=e("<div/>").addClass("updated").css("opacity",0).html('<div class="message">Slider updated</div>').appendTo("#update-status");i.animate({opacity:.9},function(){i.delay(1200).fadeOut(function(){i.remove()})}),this.$_slider_fields_box.find(".spinner").hide(),this._init_sortable()},_build_data:function(i){var t={};switch(i){case"new_slider":case"select_slider":t=e.extend({},this._data,{post_slider_name:e("select#post_slider_field").val(),new_slider_name:e("input#slider_field").val()}),"attachment"==this._context&&e.extend(t,this._data,{slide_title_field:e("input#slide_title_field").val(),slide_text_field:e("textarea#slide_text_field").val(),slide_color_field:e("input#slide_color_field").val(),slide_button_field:e("input#slide_button_field").val(),slide_link_field:e("select#slide_link_field").val(),slide_custom_link_field:e("input#slide_custom_link_field").val(),slide_link_target_field:e("input#slide_link_target_field").is(":checked")?1:"",slide_link_whole_slide_field:e("input#slide_link_whole_slide_field").is(":checked")?1:""});break;case"delete_slider":t=e.extend({},this._data,{delete_slider:!0,currentpostslider:e("select#post_slider_field").val(),new_slider_name:null});break;case"reorder_slides":t=e.extend({},this._data,{newOrder:this.$_slider_section_box.find("#sortable").sortable("toArray").toString(),currentpostslider:e("select#post_slider_field").val()});break;default:t=this._data}return t[this._check_field]=this.$_slider_check_field.is(":checked")?1:"",t},_init_ext_plugins:function(){this._init_color_picker(),this._init_iphone_check(),this._init_sortable(),this._init_multipicker()},_init_color_picker:function(){if(this._color_picker_on){var i=e("#slide_color_field");switch(this._color_picker_func){case"farbtastic":e("#colorfield").farbtastic(i);break;default:i.wpColorPicker()}}},_init_iphone_check:function(){e(".iphonecheck").iphoneStyle({checkedLabel:"Yes",uncheckedLabel:"No"})},_init_sortable:function(){this.$_slider_section_box.find("#sortable").sortable({placeholder:"ui-state-highlight"}).disableSelection()},_init_multipicker:function(){"function"==typeof e.fn.select2&&this.$_slider_section_box.find("select.czr_multiple_picker, select.tc_multiple_picker").select2({closeOnSelect:!1,formatSelection:function(e){return e.text.replace(/\u2013|\u2014/g,"")}})}}),new CzrSlider})}(jQuery);